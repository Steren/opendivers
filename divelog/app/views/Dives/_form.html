<div id="accordion">
    <h3><a href="#">Basic parameters</a></h3>
    <div>
		<div class="row">
		  <div class="label">Date</div>
		  <div class="field">
		      <script type="text/javascript">
		        $(function() {
		          $("#date").datepicker({ dateFormat: 'yy-mm-dd' } );
		        });
		      </script>
		      <!-- TODO: date format needs to come from application.conf -->
		      <input id="date" type="text" name="dive.date" 
		        value="${dive?.date?.format('yyyy-MM-dd')}"
		        size="10" />
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.date')}</span>
		</div>
		
		 <div class="row">
		  <div class="label">Spot</div>
		  <div class="field">
                <input id="spotName" type="text" name="spotName"
                value="${dive?.spot?.name}"
                size="50" />
                
                or choose
                
                <select name="spotId">
                
                <option value="">-</option>
                
                %{ models.Spot.all().fetch().sort{ it.toString() }.each() { }%
                  %{
                    selected = false;
                    if (dive?.spot?.id == it.id) {
                      selected = true
                    }
                  }%
                  <option value="${it?.id}" ${selected ? 'selected'.raw() : ''}>${it}</option>
                %{ } }%
                </select>
                
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.spot')}</span>
		</div>
		
		 <div class="row">
		  <div class="label">Max Depth</div>
		  <div class="field">
		      <input type="text" name="dive.maxDepth" value="${dive?.maxDepth}"/>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.maxDepth')}</span>
		</div>
		
		 <div class="row">
		  <div class="label">Duration</div>
		  <div class="field">
		      <input type="text" name="dive.duration" value="${dive?.duration}"/>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.duration')}</span>
		</div>
		 <div class="row">
		  <div class="label">Training</div>
		  <div class="field">
		      <input type="checkbox" name="dive.training"
		        ${dive?.training ? 'checked':''}
		      />
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.training')}</span>
		</div>
		
		 <div class="row">
		  <div class="label">Center</div>
		  <div class="field">
		        <select name="dive.center.id">
		              
		                      <option value="">(None)</option>              
		              
		        %{ models.Center.all().fetch().sort{ it.toString() }.each() { }%
		          
		          %{
		            selected = false;
		            if (dive?.center?.id == it.id) {
		              selected = true
		            }
		          }%
		          <option value="${it?.id}" ${selected ? 'selected'.raw() : ''}>${it}</option>
		        %{ } }%
		        </select>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.center')}</span>
		</div>
		
    </div>
    
    <h3><a href="#">Marine life</a></h3>
    <div>
         <div class="row">
          <div class="label">Fishes</div>
          <div class="field">
                <select name="dive.fishes.id" multiple>
                %{ models.Fish.all().fetch().sort{ it.toString() }.each() { }%
                  
                  %{
                    selected = false;
                    dive?.fishes.each() { f ->
                      if (f.id == it?.id)
                        selected = true;
                    }
                  }%
                  <option value="${it?.id}" ${selected ? 'selected'.raw() : ''}>${it}</option>
                %{ } }%
                </select>
          </div>
          <span class="error" style="display:none;">${errors.forKey('dive.fishes')}</span>
        </div>
    </div>
    
    
    <h3><a href="#">Advanced parameters</a></h3>
    <div>
		<div class="row">
		  <div class="label">Air Temperature</div>
		  <div class="field">
		      <input type="text" name="dive.airTemperature" value="${dive?.airTemperature}"/>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.airTemperature')}</span>

		  <div class="label">Water Surface Temperature</div>
		  <div class="field">
		      <input type="text" name="dive.waterSurfaceTemperature" value="${dive?.waterSurfaceTemperature}"/>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.waterSurfaceTemperature')}</span>

		  <div class="label">Water Bottom Temperature</div>
		  <div class="field">
		      <input type="text" name="dive.waterBottomTemperature" value="${dive?.waterBottomTemperature}"/>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.waterBottomTemperature')}</span>
		</div>
		
		 <div class="row">
		  <div class="label">Type</div>
		  <div class="field">
		        <select name="dive.type.id" multiple>
		        %{ models.DiveType.all().fetch().sort{ it.toString() }.each() { }%
		          
		          %{
		            selected = false;
		            dive?.type.each() { f ->
		              if (f.id == it?.id)
		                selected = true;
		            }
		          }%
		          <option value="${it?.id}" ${selected ? 'selected'.raw() : ''}>${it}</option>
		        %{ } }%
		        </select>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.type')}</span>

		  <div class="label">Water</div>
		  <div class="field">
		        <select name="dive.water.id">
		                      <option value="">(None)</option>              
		        %{ models.WaterType.all().fetch().sort{ it.toString() }.each() { }%
		          
		          %{
		            selected = false;
		            if (dive?.water?.id == it.id) {
		              selected = true
		            }
		          }%
		          <option value="${it?.id}" ${selected ? 'selected'.raw() : ''}>${it}</option>
		        %{ } }%
		        </select>
		  </div>
		  <span class="error" style="display:none;">${errors.forKey('dive.water')}</span>
		</div>
    </div>
</div>

 <div class="row">
  <div class="label"></div>
  <div class="field">
      <input type="hidden" name="dive.id" value="${dive?.id}"/>
  </div>
  <span class="error" style="display:none;">${errors.forKey('dive.id')}</span>
</div>

    <script>
    $(function() {
        $( "#accordion" ).accordion();
    });
    </script>


<div>Spot autocomplete :
%{ models.Spot.all().fetch().sort{ it.toString() }.each() { }%
  
  ${it?.id} ${it}

%{ } }%
</div>
